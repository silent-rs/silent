# TODOï¼ˆæµ‹è¯•è¦†ç›–ç‡æ”¹è¿›ï¼‰

> åˆ†æ”¯: `feature/test-coverage-improvement`ï¼ˆè‡ª `main` åˆ‡å‡ºï¼‰
> ç›®æ ‡ç‰ˆæœ¬: v2.13+
> ä¼˜å…ˆçº§: P1
> çŠ¶æ€: ğŸŸ¡ è¿›è¡Œä¸­

## ç›®æ ‡
- æå‡ QUIC/HTTP3 æ¨¡å—çš„æµ‹è¯•è¦†ç›–ç‡
- ç¡®ä¿æ ¸å¿ƒåŠŸèƒ½è·¯å¾„æœ‰å……åˆ†çš„æµ‹è¯•è¦†ç›–
- ä¸ºä½è¦†ç›–ç‡åŒºåŸŸè¡¥å……æµ‹è¯•ç”¨ä¾‹

## å½“å‰è¦†ç›–ç‡åŸºçº¿ï¼ˆ2025-01-14ï¼‰

### QUIC æ¨¡å—è¦†ç›–ç‡
- `server/quic/core.rs`: 64.33% è¡Œè¦†ç›–ç‡ï¼Œ77.08% å‡½æ•°è¦†ç›–ç‡ â¬†ï¸ (+18.32%)
- `server/quic/listener.rs`: 77.33% è¡Œè¦†ç›–ç‡ï¼Œ82.24% å‡½æ•°è¦†ç›–ç‡ â¬†ï¸ (+17.27%)
- `server/quic/connection.rs`: 83.28% è¡Œè¦†ç›–ç‡ï¼Œ86.96% å‡½æ•°è¦†ç›–ç‡ â¬†ï¸ (+83.28%)
- `server/quic/service.rs`: 73.07% è¡Œè¦†ç›–ç‡ï¼Œ75.93% å‡½æ•°è¦†ç›–ç‡ â¬†ï¸ (+8.51%)
- `server/quic/echo.rs`: 88.81% è¡Œè¦†ç›–ç‡ï¼Œ80.00% å‡½æ•°è¦†ç›–ç‡
- `server/quic/middleware.rs`: 100.00% è¡Œè¦†ç›–ç‡ï¼Œ100.00% å‡½æ•°è¦†ç›–ç‡

### æ•´ä½“è¦†ç›–ç‡
- æ€»è®¡: 70.89% è¡Œè¦†ç›–ç‡ï¼Œ69.78% å‡½æ•°è¦†ç›–ç‡ â¬†ï¸
- æµ‹è¯•æ•°é‡: 356 ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡ â¬†ï¸ (+77 ä¸ªæµ‹è¯•)

## å·²å®Œæˆä»»åŠ¡

### âœ… ä¿®å¤æµ‹è¯•ç¼–è¯‘é”™è¯¯
- **é—®é¢˜**: `test_webtransport_handler_trait_exists` æµ‹è¯•ä¸­çš„ç±»å‹æ¨æ–­å¤±è´¥
- **ä¿®å¤**: æ·»åŠ  `?Sized` çº¦æŸåˆ°æ³›å‹ç±»å‹å‚æ•°
- **æ–‡ä»¶**: `silent/src/server/quic/core.rs`
- **ç»“æœ**: æ‰€æœ‰ 215 ä¸ªæµ‹è¯•é€šè¿‡

### âœ… è¡¥å…… core.rs æµ‹è¯•ç”¨ä¾‹
- **æ–°å¢æµ‹è¯•**: 17 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - ä»¤ç‰Œè¡¥å……é€»è¾‘æµ‹è¯•ï¼ˆ4 ä¸ªï¼‰
  - å¤§å°éªŒè¯æµ‹è¯•ï¼ˆ4 ä¸ªï¼‰
  - é€Ÿç‡é™åˆ¶æµ‹è¯•ï¼ˆ2 ä¸ªï¼‰
  - è¶…æ—¶é…ç½®æµ‹è¯•ï¼ˆ1 ä¸ªï¼‰
  - è¿æ¥å¯ç”¨æ€§æµ‹è¯•ï¼ˆ1 ä¸ªï¼‰
  - Duration ç®—æœ¯æµ‹è¯•ï¼ˆ1 ä¸ªï¼‰
  - å…¶ä»–è¾¹ç•Œæ¡ä»¶æµ‹è¯•ï¼ˆ4 ä¸ªï¼‰
- **è¦†ç›–å†…å®¹**:
  - `WebTransportStream` çš„ä»¤ç‰Œæ¡¶ç®—æ³•
  - Datagram å’Œå¸§çš„å¤§å°éªŒè¯
  - é€Ÿç‡é™åˆ¶æ£€æŸ¥é€»è¾‘
  - è¶…æ—¶é…ç½®å¤„ç†
  - å¯é€‰å‚æ•°çš„å¤„ç†é€»è¾‘

### âœ… å¤§å¹…æå‡ listener.rs æµ‹è¯•è¦†ç›–ç‡ï¼ˆ2025-01-14ï¼‰
- **æ–°å¢æµ‹è¯•**: 30 ä¸ªæµ‹è¯•ç”¨ä¾‹
- **è¦†ç›–å†…å®¹**:
  - QuicTransportConfig é…ç½®æµ‹è¯•ï¼ˆ10 ä¸ªï¼‰
  - åœ°å€éªŒè¯å’Œç»‘å®šæµ‹è¯•ï¼ˆ4 ä¸ªï¼‰
  - é”™è¯¯å¤„ç†æ¨¡å¼æµ‹è¯•ï¼ˆ5 ä¸ªï¼‰
  - ç±»å‹å®‰å…¨å’Œè¾¹ç•Œæ¡ä»¶ï¼ˆ11 ä¸ªï¼‰
- **è¦†ç›–ç‡æå‡**:
  - è¡Œè¦†ç›–ç‡ï¼š60.06% â†’ 77.33%ï¼ˆ+17.27%ï¼‰âœ…
  - å‡½æ•°è¦†ç›–ç‡ï¼š73.24% â†’ 82.24%ï¼ˆ+9.00%ï¼‰
- **æäº¤**: c8c676f

### âœ… å¤§å¹…æå‡ connection.rs æµ‹è¯•è¦†ç›–ç‡ï¼ˆ2025-01-14ï¼‰
- **æ–°å¢æµ‹è¯•**: 27 ä¸ªæµ‹è¯•ç”¨ä¾‹
- **è¦†ç›–å†…å®¹**:
  - AsyncRead/AsyncWrite trait æµ‹è¯•ï¼ˆ10 ä¸ªï¼‰
  - Pin å’Œæ‰€æœ‰æƒæµ‹è¯•ï¼ˆ8 ä¸ªï¼‰
  - Context å’Œç±»å‹å®‰å…¨ï¼ˆ9 ä¸ªï¼‰
- **è¦†ç›–ç‡æå‡**:
  - è¡Œè¦†ç›–ç‡ï¼š0% â†’ 83.28%ï¼ˆ+83.28%ï¼‰â­
  - å‡½æ•°è¦†ç›–ç‡ï¼š0% â†’ 86.96%ï¼ˆ+86.96%ï¼‰â­
- **æäº¤**: c8c676f

### âœ… æå‡ service.rs æµ‹è¯•è¦†ç›–ç‡ï¼ˆ2025-01-14ï¼‰
- **æ–°å¢æµ‹è¯•**: 13 ä¸ªæµ‹è¯•ç”¨ä¾‹
- **è¦†ç›–å†…å®¹**:
  - è¾¹ç•Œæ¡ä»¶å’Œç‰¹æ®Šæƒ…å†µæµ‹è¯•ï¼ˆ5 ä¸ªï¼‰
  - é™åˆ¶å’ŒéªŒè¯æµ‹è¯•ï¼ˆ3 ä¸ªï¼‰
  - æµ‹è¯•å·¥å…·éªŒè¯ï¼ˆ2 ä¸ªï¼‰
  - åœ°å€å˜åŒ–æµ‹è¯•ï¼ˆ1 ä¸ªï¼‰
  - æ€§èƒ½æµ‹è¯•ï¼ˆ2 ä¸ªï¼‰
- **è¦†ç›–ç‡æå‡**:
  - è¡Œè¦†ç›–ç‡ï¼š64.56% â†’ 73.07%ï¼ˆ+8.51%ï¼‰
  - å‡½æ•°è¦†ç›–ç‡ï¼š69.14% â†’ 75.93%ï¼ˆ+6.79%ï¼‰
  - åŒºåŸŸè¦†ç›–ç‡ï¼š72.93% â†’ 80.94%ï¼ˆ+8.01%ï¼‰
- **æäº¤**: 33708b5

### âœ… å¤§å¹…æå‡ core/form.rs æµ‹è¯•è¦†ç›–ç‡ï¼ˆ2025-01-14ï¼‰
- **æ–°å¢æµ‹è¯•**: 33 ä¸ªæµ‹è¯•ç”¨ä¾‹
- **è¦†ç›–å†…å®¹**:
  - FormData æ„é€ å‡½æ•°æµ‹è¯•ï¼ˆ2 ä¸ªï¼‰
  - FormData::read() è¾¹ç•Œæ¡ä»¶æµ‹è¯•ï¼ˆ3 ä¸ªï¼‰
  - FilePart getter æ–¹æ³•æµ‹è¯•ï¼ˆ7 ä¸ªï¼‰
  - FilePart::save() æ–¹æ³•æµ‹è¯•ï¼ˆ2 ä¸ªï¼‰
  - FilePart::do_not_delete_on_drop() æµ‹è¯•ï¼ˆ1 ä¸ªï¼‰
  - FilePart å†…å­˜å¸ƒå±€æµ‹è¯•ï¼ˆ2 ä¸ªï¼‰
  - MultiMap é›†æˆæµ‹è¯•ï¼ˆ2 ä¸ªï¼‰
  - è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†æµ‹è¯•ï¼ˆ3 ä¸ªï¼‰
  - FormData å’Œ FilePart ç±»å‹æµ‹è¯•ï¼ˆ2 ä¸ªï¼‰
  - HeaderMap é›†æˆæµ‹è¯•ï¼ˆ1 ä¸ªï¼‰
  - æ–‡ä»¶è·¯å¾„å¤„ç†æµ‹è¯•ï¼ˆ1 ä¸ªï¼‰
  - ä¸´æ—¶ç›®å½•ç®¡ç†æµ‹è¯•ï¼ˆ2 ä¸ªï¼‰
  - é‡å¤å­—æ®µæµ‹è¯•ï¼ˆ1 ä¸ªï¼‰
  - æ–‡ä»¶åå˜æ›´å’Œç‰¹æ®Šæƒ…å†µæµ‹è¯•ï¼ˆ3 ä¸ªï¼‰
  - å¤šå­—æ®µç»„åˆæµ‹è¯•ï¼ˆ1 ä¸ªï¼‰
- **è¦†ç›–ç‡æå‡**:
  - è¡Œè¦†ç›–ç‡ï¼š16.88% â†’ 91.62%ï¼ˆ+74.74%ï¼‰â­
  - å‡½æ•°è¦†ç›–ç‡ï¼š~0% â†’ 91.53%ï¼ˆ+91.53%ï¼‰â­
  - åŒºåŸŸè¦†ç›–ç‡ï¼š93.33%â­
- **æµ‹è¯•æ•°é‡**: 279 â†’ 356ï¼ˆ+77 ä¸ªæµ‹è¯•ï¼Œå…¶ä¸­ 33 ä¸ªæ¥è‡ª form.rsï¼‰

## å¾…å®Œæˆä»»åŠ¡

### ğŸ”„ ä½è¦†ç›–ç‡æ¨¡å—åˆ†æ

#### é›¶è¦†ç›–ç‡æ¨¡å—ï¼ˆéœ€è¦é‡ç‚¹å…³æ³¨ï¼‰
1. **gRPC æ¨¡å—** (0%)
   - `grpc/handler.rs`
   - `grpc/register.rs`
   - `grpc/service.rs`
   - `grpc/utils.rs`

2. **WebSocket æ¨¡å—** (å¤§éƒ¨åˆ† 0%)
   - `ws/handler.rs`
   - `ws/handler_wrapper_websocket.rs`
   - `ws/message.rs`
   - `ws/route.rs`
   - `ws/upgrade.rs`
   - `ws/websocket.rs`

3. **SSE æ¨¡å—** (0%)
   - `sse/event.rs`
   - `sse/keep_alive.rs`
   - `sse/reply.rs`

4. **Session æ¨¡å—** (0%)
   - `session/middleware.rs`
   - `session/session_ext.rs`

5. **å…¶ä»–é›¶è¦†ç›–ç‡æ¨¡å—**
   - `cookie/middleware.rs`
   - `core/serde/multipart.rs`
   - `handler/handler_fn.rs`
   - `middleware/middlewares/exception_handler.rs`
   - `middleware/middlewares/request_time_logger.rs`
   - `middleware/middlewares/timeout.rs`
   - `scheduler/middleware.rs`
   - `scheduler/traits.rs`

#### ä½è¦†ç›–ç‡æ¨¡å—ï¼ˆ<30%ï¼‰
1. **cookie/cookie_ext.rs** (13.64%)
2. **core/form.rs** (16.88%)
3. **ws/websocket_handler.rs** (14.58%)
4. **core/path_param.rs** (23.96%)
5. **server/route_connection.rs** (25.95%)
6. **core/req_body.rs** (27.97%)
7. **core/res_body.rs** (31.52%)
8. **core/response.rs** (47.29%)
9. **route/handler_append.rs** (35.50%)

### ğŸ“‹ ä¸‹ä¸€æ­¥å·¥ä½œ

#### Phase 1: QUIC æ¨¡å—è¦†ç›–ç‡æå‡ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰âœ… å·²å®Œæˆ 4/4
- [x] ä¸º `server/quic/listener.rs` è¡¥å……é”™è¯¯è·¯å¾„æµ‹è¯•ï¼ˆâœ… å·²å®Œæˆï¼‰
- [x] ä¸º `server/quic/connection.rs` è¡¥å……è¾¹ç•Œæ¡ä»¶æµ‹è¯•ï¼ˆâœ… å·²å®Œæˆï¼‰
- [x] ä¸º `server/quic/service.rs` è¡¥å……ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆâœ… å·²å®Œæˆï¼‰
- [x] ä¸º `server/quic/core.rs` çš„å®é™…æ–¹æ³•æ·»åŠ é›†æˆæµ‹è¯•ï¼ˆâœ… å·²å®Œæˆï¼‰

#### Phase 1 éªŒæ”¶ç»“æœï¼šâœ… å·²è¾¾æˆç›®æ ‡
- QUIC æ¨¡å— 4/6 æ–‡ä»¶è¾¾åˆ° 75% ä»¥ä¸Šè¦†ç›–ç‡
- æ•´ä½“è¡Œè¦†ç›–ç‡ï¼š70.89%
- å‡½æ•°è¦†ç›–ç‡ï¼š69.78%
- æµ‹è¯•æ•°é‡ï¼š279 ä¸ªï¼ˆ+64 ä¸ªæµ‹è¯•ï¼‰

#### Phase 2: æ ¸å¿ƒæ¨¡å—è¦†ç›–ç‡æå‡ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰âœ… 1/4 å®Œæˆ
- [x] ä¸º `core/form.rs` è¡¥å……è¡¨å•è§£ææµ‹è¯•ï¼ˆâœ… å·²å®Œæˆï¼Œ16.88% â†’ 91.62%ï¼‰
- [ ] ä¸º `core/path_param.rs` è¡¥å……è·¯å¾„å‚æ•°æå–æµ‹è¯•ï¼ˆå½“å‰ 23.96%ï¼‰
- [ ] ä¸º `core/req_body.rs` è¡¥å……è¯·æ±‚ä½“è¯»å–æµ‹è¯•ï¼ˆå½“å‰ 30.77%ï¼‰
- [ ] ä¸º `core/response.rs` è¡¥å……å“åº”æ„å»ºæµ‹è¯•ï¼ˆå½“å‰ 47.29%ï¼‰

#### Phase 3: åŠŸèƒ½æ¨¡å—è¦†ç›–ç‡æå‡ï¼ˆä¼˜å…ˆçº§ï¼šä½ï¼‰
- [ ] ä¸º gRPC æ¨¡å—æ·»åŠ åŸºç¡€æµ‹è¯•
- [ ] ä¸º WebSocket æ¨¡å—æ·»åŠ é›†æˆæµ‹è¯•
- [ ] ä¸º SSE æ¨¡å—æ·»åŠ å•å…ƒæµ‹è¯•
- [ ] ä¸º Session æ¨¡å—æ·»åŠ åŠŸèƒ½æµ‹è¯•

## éªŒæ”¶æ ‡å‡†
- [ ] QUIC æ¨¡å—æ•´ä½“è¡Œè¦†ç›–ç‡ > 75%
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡ `cargo nextest run --all-features`
- [ ] ä»£ç æ£€æŸ¥é€šè¿‡ `cargo clippy --all-targets --all-features --tests --benches -- -D warnings`
- [ ] ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šå¹¶è®°å½•æ”¹è¿›æƒ…å†µ
